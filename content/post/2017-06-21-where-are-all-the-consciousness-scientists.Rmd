---
title: Where are all the consciousness scientists?
author: Matti Vuorre
date: '2017-06-21'
slug: where-are-all-the-consciousness-scientists
categories:
  - psychology
tags:
  - consciousness
  - data visualization
  - psychology
draft: false
output:
  blogdown::html_page:
    toc: true
    number_sections: false
    toc_depth: 2
summary: "In this blog post, I use metadata from 70k Psychology journal articles, published in 25 journals from Scopus, to visualize 'consciousness hubs', or academic institutions that publish (more than other institutions) research on consciousness."
---

```{r, message = F, echo = F}
library(knitr)
opts_chunk$set(
  echo=F, 
  error=T, 
  warning=F, 
  message=F, 
  fig.cap=T,
  cache = T
)
library(igraph)
library(tidyverse)
library(psychLit)
library(stringr)
library(ggmap)
library(maps)
theme_set(theme_linedraw())
```

Previously, I used metadata from a selection of ~20 Psychology journals to explore citations and publication numbers and to draw co-author networks. Today, I'm interested in looking at the distribution of interest in consciousness as a research topic. I'll first look at the time-course of this topic in the psychological literature, and then visualize "consciousness hubs", i.e. academic institutions that publish research on consciousness.

You might ask: "Why"? Some decades ago, scientific research on this topic was somewhat limited, or so I am told (e.g. Gray 2004). Today there are at least two scientific conferences (which I frequent) on the topic, and it is not uncommon to find "consciousness" listed on an early career researchers webpage as a research interest. It is then natural to ask how this interest has changed over time in the literature, and if there are institutions, cities, or countries where this research interest is particularly common. I used data from the [psychLit R data package](https://github.com/mvuorre/psychLit/) to address these questions.

# Interest in consciousness across time

```{r prepare-data}
# Prepare data
# The `psychLit` data set contains many variables which we don't need. To reduce clutter, I'll only select the variables of interest to the current session:
d <- select(psychLit, Year, `Author Keywords`, `Abbreviated Source Title`,
            Abstract, Authors, `Authors with affiliations`)

# I'll also create a new variable called `item` which identifies each row (article) with a unique number:
d$item <- 1:nrow(d)

# Many articles, especially older ones, lack much of the metadata. I'll remove these articles from the data set:
d <- filter(d, !is.na(Abstract) & !is.na(`Author Keywords`))

# That left us with about 30k usable articles. This brings us to the first data reshaping operation. Each article with multiple authors has the authors listed in a comma separated text string.
# To make the data easier to work with, I'll make the "list-ness" of this variable explicit, by converting the `Authors` variable into an R list column.
d <- d %>% mutate(Authors = strsplit(Authors, ", "))

# More importantly, the `Authors with affiliations` variable contains a list of authors and their addresses. I'll also convert it to a list where each entry is an author, and her/his address:
d <- d %>% 
    mutate(Addresses = strsplit(`Authors with affiliations`, "; ")) %>% 
    select(-`Authors with affiliations`)
d <- d %>% select(Year, Authors, Addresses, everything())

d$item <- 1:nrow(d)
d <- d %>% 
    mutate(consc = grepl("consciousness", `Author Keywords`, ignore.case = T) | 
               grepl("consciousness", Abstract, ignore.case = T),
           attention = grepl("attention*", `Author Keywords`, ignore.case = T) | 
               grepl("attention*", Abstract, ignore.case = T))
d <- filter(d, Year < 2017)
```

I first asked if there was, across all the 20 journals in the database, any obvious change in how often the term "consciousness" was mentioned.

```{r term-count, fig.cap = "Number of articles where 'consciousness' was used in either the keywords or abstracts."}
d %>% 
    group_by(Year) %>% 
    summarize(consc = sum(consc, na.rm=T)) %>% 
    ggplot(aes(Year, consc)) +
    geom_point() +
    labs(y= "Number of articles")
```

The upward trend after 1995 or so, in Figure \@ref(fig:term-count), seems to verify the anecdote that for many decades, this topic was off limits for mainstream psychology. Or does it? Maybe there are now more articles overall. To find out, we can compare the term to another one, such as "attention":

```{r term-count-comparison, fig.cap = "Number of articles where 'consciousness' was used in either the keywords or abstracts, compared to the number of articles on 'attention'."}
d %>% 
    group_by(Year) %>% 
    summarize(consc = sum(consc, na.rm=T),
              attention = sum(attention, na.rm=T)) %>% 
    ggplot(aes(Year)) +
    geom_line(aes(y=consc, color = "Consciousness")) +
    geom_line(aes(y=attention, color = "Attention")) +
    labs(y = "Number of articles") + 
    theme(legend.position = "bottom")
```

Figure \@ref(fig:term-count-comparison) instead suggests that the term 'consciousness' now appears more often because there is an overall increase in the number of published articles. Perhaps counting articles is the wrong approach in the first place. It might be better to look at the proportion of articles on consciousness for each year.

```{r term-proportion, fig.cap = "Proportion of articles where 'consciousness' was used in either the keywords or abstracts."}
d %>% 
    group_by(Year) %>% 
    summarize(consc = sum(consc, na.rm=T),
              total = n()) %>% 
    ggplot(aes(Year, consc/total)) +
    geom_point() +
    labs(y= "Proportion of articles")
```

Figure \@ref(fig:term-proportion) shows that interest in consciousness peaked at the turn of the 19th and 20th centuries, and has only declined since. Here's an example William James quote to illustrate how the word was used a hundred years ago:

>"Our normal waking consciousness, rational consciousness as we call it, is but one special type of consciousness, whilst all about it, parted from it by the filmiest of screens, there lie potential forms of consciousness entirely different."


# Consciousness hubs

Next, let's take a look at where these articles were published. Below, I'll show 15 institutions with the highest proportion[^eb] of consciousness articles; these are the 'consciousness hubs'. 

[^eb]: Because the number of articles varies dramatically between institutions (e.g. an institution may have 2 articles in the database, and if one of those was on consciousness, the institution's proportion would erroneously be inferred as .5) I used empirical Bayes estimation to get the proportions.

```{r}
# Add location info
world <- as_tibble(world.cities) %>% 
    select(City = name, Country = country.etc, long, lat, pop)
# Drop duplicate cities (assume more populous is correct)
world <- world %>% 
    distinct(City, Country, .keep_all=T)

# Must find country first
dgeo <- d %>% 
    # Get author country
    unnest(Addresses, .drop = FALSE) %>% 
    mutate(Addresses = gsub("United Kingdom", "UK", Addresses)) %>% 
    mutate(Addresses = gsub("United States", "USA", Addresses)) %>% 
    mutate(Country = strsplit(Addresses, ", ")) %>%
    unnest(Country, .drop = F) %>% 
    inner_join(distinct(world, Country)) %>% 
    arrange(item) %>% 
    # Get author City
    unnest(Addresses, .drop = FALSE) %>%
    mutate(Addresses = gsub("United Kingdom", "UK", Addresses)) %>% 
    mutate(Addresses = gsub("United States", "USA", Addresses)) %>% 
    mutate(City = strsplit(Addresses, ", ")) %>%
    unnest(City, .drop = F) %>% 
    inner_join(distinct(world, Country, City)) %>%
    left_join(world) %>% 
    select(-Addresses)
dgeo <- distinct(dgeo)
```

```{r}
sumconsc <- group_by(dgeo, Country, City, long, lat) %>% 
    summarise(k = sum(consc), n = n()) %>% 
    ungroup()
sumconsc <- sumconsc %>% 
    arrange(Country, City) %>% 
    rownames_to_column() %>% 
    mutate(p_mle = k/n,
           City2 = paste0(Country, "_", City))

library(lme4)
bmod <- glmer(cbind(k, n - k) ~ 1 + (1|Country) + (1|City2),
              family = binomial, data = sumconsc)
citycoefs <- arm::invlogit(coef(bmod)$City2)
citycoefs$City2 <- row.names(citycoefs)
citycoefs <- rename(citycoefs, p_eb = `(Intercept)`)
sumconsc <- left_join(sumconsc, citycoefs)
```

```{r}
pd <- sumconsc %>% 
    arrange(Country, p_eb) %>%
    mutate(order = row_number()) %>% 
    gather(method, estimate, p_mle, p_eb)

topcountry <- pd %>% 
    group_by(Country) %>% 
    summarise(N = n()) %>% 
    top_n(9, wt=N)
```

```{r}
bbox <- c(left = -155, bottom = -55, right = 170, top = 70)
mymap <- get_map(bbox, 2, source = "stamen", maptype = "toner-lite")
```

```{r map-figure, fig.cap = "Map of top 15 consciousness hubs (Pasadena seems to be misplaced). Each blue dot's size and opacity is proportional to the proportion of consciousness articles within that city's institutions."}
library(ggrepel)
theme_set(theme_gray())
labeldata <- sumconsc %>% 
    filter(k > 2) %>%
    arrange(desc(p_eb)) %>% 
    slice(1:15)

ggmap(mymap, extent = "device", legend = "bottomleft",
      base_layer = ggplot(aes(x = long, y = lat), data = sumconsc)) +
    geom_point(col = "dodgerblue3", aes(alpha = p_eb, size=k), 
               show.legend = F) +
    geom_label_repel(data = labeldata, aes(label = City),
                     box.padding = unit(.5, "lines"))
```

I am surprised to see Turku in Figure \@ref(fig:term-proportion), although I knew that there are a few active researchers on this topic at University of Turku.

Find the source code for these figures at [GitHub](https://github.com/mvuorre/blog).

# References

<div class="csl-bib-body" style="line-height: 2; padding-left: 2em; text-indent:-2em;">
  <div class="csl-entry">Gray, J. A. (2004). <i>Consciousness: Creeping Up on the Hard Problem</i>. Oxford University Press.</div>
  <span class="Z3988" title="url_ver=Z39.88-2004&amp;ctx_ver=Z39.88-2004&amp;rfr_id=info%3Asid%2Fzotero.org%3A2&amp;rft_id=urn%3Aisbn%3A978-0-19-852090-0&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=book&amp;rft.btitle=Consciousness%3A%20Creeping%20Up%20on%20the%20Hard%20Problem&amp;rft.publisher=Oxford%20University%20Press&amp;rft.aufirst=Jeffrey%20Alan&amp;rft.aulast=Gray&amp;rft.au=Jeffrey%20Alan%20Gray&amp;rft.date=2004&amp;rft.tpages=380&amp;rft.isbn=978-0-19-852090-0&amp;rft.language=en"></span>
</div>

